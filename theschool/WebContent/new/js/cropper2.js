!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function Y(a){return"number"==typeof a&&!isNaN(a)}function Z(a){return"undefined"==typeof a}function $(a,b){var c=[];return Y(b)&&c.push(b),c.slice.apply(a,c)}function _(a,b){var c=$(arguments,2);return function(){return a.apply(b,c.concat($(arguments)))}}function aa(a){var b=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return b&&(b[1]!==d.protocol||b[2]!==d.hostname||b[3]!==d.port)}function ba(a){var b="timestamp="+(new Date).getTime();return a+(a.indexOf("?")===-1?"?":"&")+b}function ca(a){var b=[],c=a.rotate,d=a.scaleX,e=a.scaleY;return Y(c)&&b.push("rotate("+c+"deg)"),Y(d)&&Y(e)&&b.push("scale("+d+","+e+")"),b.length?b.join(" "):"none"}function da(a,b){var j,k,c=T(a.degree)%180,d=(c>90?180-c:c)*Math.PI/180,e=U(d),f=V(d),g=a.width,h=a.height,i=a.aspectRatio;return b?(j=g/(f+e/i),k=j/i):(j=g*f+h*e,k=g*e+h*f),{width:j,height:k}}function ea(b,c){var r,s,t,d=a("<canvas>")[0],e=d.getContext("2d"),f=0,g=0,h=c.naturalWidth,i=c.naturalHeight,j=c.rotate,k=c.scaleX,l=c.scaleY,m=Y(k)&&Y(l)&&(1!==k||1!==l),n=Y(j)&&0!==j,o=n||m,p=h,q=i;return m&&(r=h/2,s=i/2),n&&(t=da({width:h,height:i,degree:j}),p=t.width,q=t.height,r=t.width/2,s=t.height/2),d.width=p,d.height=q,o&&(f=-h/2,g=-i/2,e.save(),e.translate(r,s)),n&&e.rotate(j*Math.PI/180),m&&e.scale(k,l),e.drawImage(b,f,g,h,i),o&&e.restore(),d}function fa(b,c){this.$element=a(b),this.options=a.extend({},fa.DEFAULTS,a.isPlainObject(c)&&c),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.replaced=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.imageCropLoaded=!1}var b=a(window),c=a(document),d=window.location,e="cropper",f="preview."+e,g="cropper-modal",h="cropper-hide",i="cropper-hidden",j="cropper-invisible",k="cropper-move",l="cropper-crop",m="cropper-disabled",n="cropper-bg",o="mousedown touchstart pointerdown MSPointerDown",p="mousemove touchmove pointermove MSPointerMove",q="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",r="wheel mousewheel DOMMouseScroll",s="dblclick",t="resize."+e,u="build."+e,v="built."+e,w="cropstart."+e,x="cropmove."+e,y="cropend."+e,z="crop."+e,A="zoom."+e,B=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,C="e",D="w",E="s",F="n",G="se",H="sw",I="ne",J="nw",K="all",L="crop",M="move",N="zoom",O="none",P=a.isFunction(a("<canvas>")[0].getContext),Q=Math.sqrt,R=Math.min,S=Math.max,T=Math.abs,U=Math.sin,V=Math.cos,W=parseFloat,X={};a.extend(X,{init:function(){var b,a=this.$element;if(a.is("img")){if(this.isImg=!0,this.originalUrl=b=a.attr("src"),!b)return;b=a.prop("src")}else a.is("canvas")&&P&&(b=a[0].toDataURL());this.load(b)},trigger:function(b,c){var d=a.Event(b,c);return this.$element.trigger(d),d.isDefaultPrevented()},load:function(b){var f,g,c=this.options,d=this.$element,e="";b&&(d.one(u,c.build),this.trigger(u)||(c.checkImageOrigin&&aa(b)&&(e=' crossOrigin="anonymous"',d.prop("crossOrigin")||(f=ba(b))),this.$clone=g=a("<img"+e+' src="'+(f||b)+'">'),g.one("load",a.proxy(function(){var a=g[0],c=a.naturalWidth||a.width,d=a.naturalHeight||a.height;this.image={naturalWidth:c,naturalHeight:d,aspectRatio:c/d},this.imageCropLoaded||(this.url=b,this.ready=!0,this.build(),this.imageCropLoaded=!0)},this)).one("error",function(){g.remove()})))}}),a.extend(X,{build:function(){var e,f,l,b=this.options,c=this.$element,d=this.$clone;this.ready&&(this.built&&this.unbuild(),this.$cropper=e=a(fa.TEMPLATE),c.addClass(i),d.removeClass(h),this.$container=c.parent().append(e),this.$canvas=e.find(".cropper-canvas").append(d),this.$dragBox=e.find(".cropper-drag-box"),this.$cropBox=f=e.find(".cropper-crop-box"),this.$viewBox=e.find(".cropper-view-box"),this.$face=l=f.find(".cropper-face"),this.initPreview(),this.bind(),b.aspectRatio=W(b.aspectRatio)||NaN,b.autoCrop?(this.cropped=!0,b.modal&&this.$dragBox.addClass(g)):f.addClass(i),b.guides||f.find(".cropper-dashed").addClass(i),b.center||f.find(".cropper-center").addClass(i),b.cropBoxMovable&&l.addClass(k).data("action",K),b.highlight||l.addClass(j),b.background&&e.addClass(n),b.cropBoxResizable||f.find(".cropper-line, .cropper-point").addClass(i),this.setDragMode(b.dragCrop?L:b.movable?M:O),this.built=!0,this.render(),this.setData(b.data),c.one(v,b.built),this.trigger(v))},unbuild:function(){this.built&&(this.built=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)}}),a.extend(X,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.options,b=this.$element,c=this.$container,d=this.$cropper;d.addClass(i),b.removeClass(i),d.css(this.container={width:S(c.width(),W(a.minContainerWidth)||200),height:S(c.height(),W(a.minContainerHeight)||100)}),b.addClass(i),d.removeClass(i)},initCanvas:function(){var b=this.container,c=b.width,d=b.height,e=this.image,f=e.aspectRatio,g={aspectRatio:f,width:c,height:d};d*f>c?g.height=c/f:g.width=d*f,g.oldLeft=g.left=(c-g.width)/2,g.oldTop=g.top=(d-g.height)/2,this.canvas=g,this.limitCanvas(!0,!0),this.initialImage=a.extend({},e),this.initialCanvas=a.extend({},g)},limitCanvas:function(b,c){var p,q,d=this.options,e=d.strict,f=this.container,g=f.width,h=f.height,i=this.canvas,j=i.aspectRatio,k=this.cropBox,l=this.cropped&&k,m=this.initialCanvas||i,n=m.width,o=m.height;b&&(p=W(d.minCanvasWidth)||0,q=W(d.minCanvasHeight)||0,p?(e&&(p=S(l?k.width:n,p)),q=p/j):q?(e&&(q=S(l?k.height:o,q)),p=q*j):e&&(l?(p=k.width,q=k.height,q*j>p?p=q*j:q=p/j):(p=n,q=o)),a.extend(i,{minWidth:p,minHeight:q,maxWidth:1/0,maxHeight:1/0})),c&&(e?l?(i.minLeft=R(k.left,k.left+k.width-i.width),i.minTop=R(k.top,k.top+k.height-i.height),i.maxLeft=k.left,i.maxTop=k.top):(i.minLeft=R(0,g-i.width),i.minTop=R(0,h-i.height),i.maxLeft=S(0,g-i.width),i.maxTop=S(0,h-i.height)):(i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=g,i.maxTop=h))},renderCanvas:function(a){var e,f,b=this.options,c=this.canvas,d=this.image;this.rotated&&(this.rotated=!1,f=da({width:d.width,height:d.height,degree:d.rotate}),e=f.width/f.height,e!==c.aspectRatio&&(c.left-=(f.width-c.width)/2,c.top-=(f.height-c.height)/2,c.width=f.width,c.height=f.height,c.aspectRatio=e,this.limitCanvas(!0,!1))),(c.width>c.maxWidth||c.width<c.minWidth)&&(c.left=c.oldLeft),(c.height>c.maxHeight||c.height<c.minHeight)&&(c.top=c.oldTop),c.width=R(S(c.width,c.minWidth),c.maxWidth),c.height=R(S(c.height,c.minHeight),c.maxHeight),this.limitCanvas(!1,!0),c.oldLeft=c.left=R(S(c.left,c.minLeft),c.maxLeft),c.oldTop=c.top=R(S(c.top,c.minTop),c.maxTop),this.$canvas.css({width:c.width,height:c.height,left:c.left,top:c.top}),this.renderImage(),this.cropped&&b.strict&&this.limitCropBox(!0,!0),a&&this.output()},renderImage:function(b){var e,c=this.canvas,d=this.image;d.rotate&&(e=da({width:c.width,height:c.height,degree:d.rotate,aspectRatio:d.aspectRatio},!0)),a.extend(d,e?{width:e.width,height:e.height,left:(c.width-e.width)/2,top:(c.height-e.height)/2}:{width:c.width,height:c.height,left:0,top:0}),this.$clone.css({width:d.width,height:d.height,marginLeft:d.left,marginTop:d.top,transform:ca(d)}),b&&this.output()},initCropBox:function(){var b=this.options,c=this.canvas,d=b.aspectRatio,e=W(b.autoCropArea)||.8,f={width:c.width,height:c.height};d&&(c.height*d>c.width?f.height=f.width/d:f.width=f.height*d),this.cropBox=f,this.limitCropBox(!0,!0),f.width=R(S(f.width,f.minWidth),f.maxWidth),f.height=R(S(f.height,f.minHeight),f.maxHeight),f.width=S(f.minWidth,f.width*e),f.height=S(f.minHeight,f.height*e),f.oldLeft=f.left=c.left+(c.width-f.width)/2,f.oldTop=f.top=c.top+(c.height-f.height)/2,this.initialCropBox=a.extend({},f)},limitCropBox:function(a,b){var k,l,c=this.options,d=c.strict,e=this.container,f=e.width,g=e.height,h=this.canvas,i=this.cropBox,j=c.aspectRatio;a&&(k=W(c.minCropBoxWidth)||0,l=W(c.minCropBoxHeight)||0,i.minWidth=R(f,k),i.minHeight=R(g,l),i.maxWidth=R(f,d?h.width:f),i.maxHeight=R(g,d?h.height:g),j&&(i.maxHeight*j>i.maxWidth?(i.minHeight=i.minWidth/j,i.maxHeight=i.maxWidth/j):(i.minWidth=i.minHeight*j,i.maxWidth=i.maxHeight*j)),i.minWidth=R(i.maxWidth,i.minWidth),i.minHeight=R(i.maxHeight,i.minHeight)),b&&(d?(i.minLeft=S(0,h.left),i.minTop=S(0,h.top),i.maxLeft=R(f,h.left+h.width)-i.width,i.maxTop=R(g,h.top+h.height)-i.height):(i.minLeft=0,i.minTop=0,i.maxLeft=f-i.width,i.maxTop=g-i.height))},renderCropBox:function(){var a=this.options,b=this.container,c=b.width,d=b.height,e=this.cropBox;(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=R(S(e.width,e.minWidth),e.maxWidth),e.height=R(S(e.height,e.minHeight),e.maxHeight),this.limitCropBox(!1,!0),e.oldLeft=e.left=R(S(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=R(S(e.top,e.minTop),e.maxTop),a.movable&&a.cropBoxMovable&&this.$face.data("action",e.width===c&&e.height===d?M:K),this.$cropBox.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.cropped&&a.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),this.trigger(z,this.getData())}}),a.extend(X,{initPreview:function(){var b=this.url;this.$preview=a(this.options.preview),this.$viewBox.html('<img src="'+b+'">'),this.$preview.each(function(){var c=a(this);c.data(f,{width:c.width(),height:c.height(),original:c.html()}),c.html('<img src="'+b+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important">')})},resetPreview:function(){this.$preview.each(function(){var b=a(this);b.html(b.data(f).original).removeData(f)})},preview:function(){var b=this.image,c=this.canvas,d=this.cropBox,e=b.width,g=b.height,h=d.left-c.left-b.left,i=d.top-c.top-b.top;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:e,height:g,marginLeft:-h,marginTop:-i,transform:ca(b)}),this.$preview.each(function(){var c=a(this),j=c.data(f),k=j.width/d.width,l=j.width,m=d.height*k;m>j.height&&(k=j.height/d.height,l=d.width*k,m=j.height),c.width(l).height(m).find("img").css({width:e*k,height:g*k,marginLeft:-h*k,marginTop:-i*k,transform:ca(b)})}))}}),a.extend(X,{bind:function(){var d=this.options,e=this.$element,f=this.$cropper;a.isFunction(d.cropstart)&&e.on(w,d.cropstart),a.isFunction(d.cropmove)&&e.on(x,d.cropmove),a.isFunction(d.cropend)&&e.on(y,d.cropend),a.isFunction(d.crop)&&e.on(z,d.crop),a.isFunction(d.zoom)&&e.on(A,d.zoom),f.on(o,a.proxy(this.cropStart,this)),d.zoomable&&d.mouseWheelZoom&&f.on(r,a.proxy(this.wheel,this)),d.doubleClickToggle&&f.on(s,a.proxy(this.dblclick,this)),c.on(p,this._cropMove=_(this.cropMove,this)).on(q,this._cropEnd=_(this.cropEnd,this)),d.responsive&&b.on(t,this._resize=_(this.resize,this))},unbind:function(){var d=this.options,e=this.$element,f=this.$cropper;a.isFunction(d.cropstart)&&e.off(w,d.cropstart),a.isFunction(d.cropmove)&&e.off(x,d.cropmove),a.isFunction(d.cropend)&&e.off(y,d.cropend),a.isFunction(d.crop)&&e.off(z,d.crop),a.isFunction(d.zoom)&&e.off(A,d.zoom),f.off(o,this.cropStart),d.zoomable&&d.mouseWheelZoom&&f.off(r,this.wheel),d.doubleClickToggle&&f.off(s,this.dblclick),c.off(p,this._cropMove).off(q,this._cropEnd),d.responsive&&b.off(t,this._resize)}}),a.extend(X,{resize:function(){var d,e,f,b=this.$container,c=this.container;!this.disabled&&c&&(f=b.width()/c.width,1===f&&b.height()===c.height||(d=this.getCanvasData(),e=this.getCropBoxData(),this.render(),this.setCanvasData(a.each(d,function(a,b){d[a]=b*f})),this.setCropBoxData(a.each(e,function(a,b){e[a]=b*f}))))},dblclick:function(){this.disabled||(this.$dragBox.hasClass(l)?this.setDragMode(M):this.setDragMode(L))},wheel:function(a){var b=a.originalEvent,c=b,d=W(this.options.wheelZoomRatio)||.1,e=1;this.disabled||(a.preventDefault(),c.deltaY?e=c.deltaY>0?1:-1:c.wheelDelta?e=-c.wheelDelta/120:c.detail&&(e=c.detail>0?1:-1),this.zoom(-e*d,b))},cropStart:function(b){var h,i,c=this.options,d=b.originalEvent,e=d&&d.touches,f=d||b;if(!this.disabled){if(e){if(h=e.length,h>1){if(!c.zoomable||!c.touchDragZoom||2!==h)return;f=e[1],this.startX2=f.pageX,this.startY2=f.pageY,i=N}f=e[0]}if(i=i||a(f.target).data("action"),B.test(i)){if(this.trigger(w,{originalEvent:d,action:i}))return;b.preventDefault(),this.action=i,this.cropping=!1,this.startX=f.pageX,this.startY=f.pageY,i===L&&(this.cropping=!0,this.$dragBox.addClass(g))}}},cropMove:function(a){var g,b=this.options,c=a.originalEvent,d=c&&c.touches,e=c||a,f=this.action;if(!this.disabled){if(d){if(g=d.length,g>1){if(!b.zoomable||!b.touchDragZoom||2!==g)return;e=d[1],this.endX2=e.pageX,this.endY2=e.pageY}e=d[0]}if(f){if(this.trigger(x,{originalEvent:c,action:f}))return;a.preventDefault(),this.endX=e.pageX,this.endY=e.pageY,this.change(e.shiftKey,f===N?c:null)}}},cropEnd:function(a){var b=a.originalEvent,c=this.action;this.disabled||c&&(a.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(g,this.cropped&&this.options.modal)),this.action="",this.trigger(y,{originalEvent:b,action:c}))}}),a.extend(X,{change:function(a,b){var u,v,c=this.options,d=c.aspectRatio,e=this.action,f=this.container,g=this.canvas,h=this.cropBox,j=h.width,k=h.height,l=h.left,m=h.top,n=l+j,o=m+k,p=0,q=0,r=f.width,s=f.height,t=!0;switch(!d&&a&&(d=j&&k?j/k:1),c.strict&&(p=h.minLeft,q=h.minTop,r=p+R(f.width,g.width),s=q+R(f.height,g.height)),v={x:this.endX-this.startX,y:this.endY-this.startY},d&&(v.X=v.y*d,v.Y=v.x/d),e){case K:l+=v.x,m+=v.y;break;case C:if(v.x>=0&&(n>=r||d&&(m<=q||o>=s))){t=!1;break}j+=v.x,d&&(k=j/d,m-=v.Y/2),j<0&&(e=D,j=0);break;case F:if(v.y<=0&&(m<=q||d&&(l<=p||n>=r))){t=!1;break}k-=v.y,m+=v.y,d&&(j=k*d,l+=v.X/2),k<0&&(e=E,k=0);break;case D:if(v.x<=0&&(l<=p||d&&(m<=q||o>=s))){t=!1;break}j-=v.x,l+=v.x,d&&(k=j/d,m+=v.Y/2),j<0&&(e=C,j=0);break;case E:if(v.y>=0&&(o>=s||d&&(l<=p||n>=r))){t=!1;break}k+=v.y,d&&(j=k*d,l-=v.X/2),k<0&&(e=F,k=0);break;case I:if(d){if(v.y<=0&&(m<=q||n>=r)){t=!1;break}k-=v.y,m+=v.y,j=k*d}else v.x>=0?n<r?j+=v.x:v.y<=0&&m<=q&&(t=!1):j+=v.x,v.y<=0?m>q&&(k-=v.y,m+=v.y):(k-=v.y,m+=v.y);j<0&&k<0?(e=H,k=0,j=0):j<0?(e=J,j=0):k<0&&(e=G,k=0);break;case J:if(d){if(v.y<=0&&(m<=q||l<=p)){t=!1;break}k-=v.y,m+=v.y,j=k*d,l+=v.X}else v.x<=0?l>p?(j-=v.x,l+=v.x):v.y<=0&&m<=q&&(t=!1):(j-=v.x,l+=v.x),v.y<=0?m>q&&(k-=v.y,m+=v.y):(k-=v.y,m+=v.y);j<0&&k<0?(e=G,k=0,j=0):j<0?(e=I,j=0):k<0&&(e=H,k=0);break;case H:if(d){if(v.x<=0&&(l<=p||o>=s)){t=!1;break}j-=v.x,l+=v.x,k=j/d}else v.x<=0?l>p?(j-=v.x,l+=v.x):v.y>=0&&o>=s&&(t=!1):(j-=v.x,l+=v.x),v.y>=0?o<s&&(k+=v.y):k+=v.y;j<0&&k<0?(e=I,k=0,j=0):j<0?(e=G,j=0):k<0&&(e=J,k=0);break;case G:if(d){if(v.x>=0&&(n>=r||o>=s)){t=!1;break}j+=v.x,k=j/d}else v.x>=0?n<r?j+=v.x:v.y>=0&&o>=s&&(t=!1):j+=v.x,v.y>=0?o<s&&(k+=v.y):k+=v.y;j<0&&k<0?(e=J,k=0,j=0):j<0?(e=H,j=0):k<0&&(e=I,k=0);break;case M:g.left+=v.x,g.top+=v.y,this.renderCanvas(!0),t=!1;break;case N:this.zoom(function(a,b,c,d){var e=Q(a*a+b*b),f=Q(c*c+d*d);return(f-e)/e}(T(this.startX-this.startX2),T(this.startY-this.startY2),T(this.endX-this.endX2),T(this.endY-this.endY2)),b),this.startX2=this.endX2,this.startY2=this.endY2,t=!1;break;case L:v.x&&v.y&&(u=this.$cropper.offset(),l=this.startX-u.left,m=this.startY-u.top,j=h.minWidth,k=h.minHeight,v.x>0?v.y>0?e=G:(e=I,m-=k):v.y>0?(e=H,l-=j):(e=J,l-=j,m-=k),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(i)))}t&&(h.width=j,h.height=k,h.left=l,h.top=m,this.action=e,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY}}),a.extend(X,{crop:function(){this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(g),this.$cropBox.removeClass(i)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.built&&!this.disabled&&(this.image=a.extend({},this.initialImage),this.canvas=a.extend({},this.initialCanvas),this.cropBox=a.extend({},this.initialCropBox),this.renderCanvas(),this.cropped&&this.renderCropBox())},clear:function(){this.cropped&&!this.disabled&&(a.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(g),this.$cropBox.addClass(i))},replace:function(a){!this.disabled&&a&&(this.isImg&&this.$element.attr("src",a),this.options.data=null,this.load(a))},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(m))},disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass(m))},destroy:function(){var a=this.$element;this.ready?(this.isImg&&a.attr("src",this.originalUrl),this.unbuild(),a.removeClass(i)):this.$clone&&this.$clone.remove(),a.removeData(e)},move:function(a,b){var c=this.canvas;Z(b)&&(b=a),a=W(a),b=W(b),this.built&&!this.disabled&&this.options.movable&&(c.left+=Y(a)?a:0,c.top+=Y(b)?b:0,this.renderCanvas(!0))},zoom:function(a,b){var d,e,c=this.canvas;if(a=W(a),a&&this.built&&!this.disabled&&this.options.zoomable){if(this.trigger(A,{originalEvent:b,ratio:a}))return;a=a<0?1/(1-a):1+a,d=c.width*a,e=c.height*a,c.left-=(d-c.width)/2,c.top-=(e-c.height)/2,c.width=d,c.height=e,this.renderCanvas(!0),this.setDragMode(M)}},rotate:function(a){var b=this.image,c=b.rotate||0;a=W(a)||0,this.built&&!this.disabled&&this.options.rotatable&&(b.rotate=(c+a)%360,this.rotated=!0,this.renderCanvas(!0))},scale:function(a,b){var c=this.image;Z(b)&&(b=a),a=W(a),b=W(b),this.built&&!this.disabled&&this.options.scalable&&(c.scaleX=Y(a)?a:1,c.scaleY=Y(b)?b:1,this.renderImage(!0))},getData:function(b){var g,h,c=this.options,d=this.image,e=this.canvas,f=this.cropBox;return this.built&&this.cropped?(h={x:f.left-e.left,y:f.top-e.top,width:f.width,height:f.height},g=d.width/d.naturalWidth,a.each(h,function(a,c){c/=g,h[a]=b?Math.round(c):c})):h={x:0,y:0,width:0,height:0},c.rotatable&&(h.rotate=d.rotate||0),c.scalable&&(h.scaleX=d.scaleX||1,h.scaleY=d.scaleY||1),h},getPlaneCanvas:function(b){var c,d,e,f,g,h,i,j,k,l,n=this.image,k=this.canvas;return c=n.width,d=n.height,j=c/d,a.isPlainObject(b)&&(g=b.width,h=b.height,g?(h=g/j,i=g/c):h&&(g=h*j,i=h/d)),e=g,f=h,k=a("<canvas>")[0],k.width=e,k.height=f,l=k.getContext("2d"),b.fillColor&&(l.fillStyle=b.fillColor,l.fillRect(0,0,e,f)),l.drawImage.apply(l,function(){var j,k,l,m,n,o,a=ea(this.$clone[0],this.image),b=a.width,e=a.height,f=[a],g=0,h=0;return g<=-c||g>b?g=j=l=n=0:g<=0?(l=-g,g=0,j=n=R(b,c+g)):g<=b&&(l=0,j=n=R(c,b-g)),j<=0||h<=-d||h>e?h=k=m=o=0:h<=0?(m=-h,h=0,k=o=R(e,d+h)):h<=e&&(m=0,k=o=R(d,e-h)),f.push(g,h,j,k),i&&(l*=i,m*=i,n*=i,o*=i),n>0&&o>0&&f.push(l,m,n,o),f}.call(this)),k},setData:function(b){var f,c=this.image,d=this.canvas,e={};a.isFunction(b)&&(b=b.call(this.$element)),this.built&&!this.disabled&&a.isPlainObject(b)&&(Y(b.rotate)&&b.rotate!==c.rotate&&this.options.rotatable&&(c.rotate=b.rotate,this.rotated=!0,this.renderCanvas(!0)),f=c.width/c.naturalWidth,Y(b.x)&&(e.left=b.x*f+d.left),Y(b.y)&&(e.top=b.y*f+d.top),Y(b.width)&&(e.width=b.width*f),Y(b.height)&&(e.height=b.height*f),this.setCropBoxData(e))},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var b,a=this.canvas;return this.built&&(b={left:a.left,top:a.top,width:a.width,height:a.height}),b||{}},setCanvasData:function(b){var c=this.canvas,d=c.aspectRatio;a.isFunction(b)&&(b=b.call(this.$element)),this.built&&!this.disabled&&a.isPlainObject(b)&&(Y(b.left)&&(c.left=b.left),Y(b.top)&&(c.top=b.top),Y(b.width)?(c.width=b.width,c.height=b.width/d):Y(b.height)&&(c.height=b.height,c.width=b.height*d),this.renderCanvas(!0))},getCropBoxData:function(){var b,a=this.cropBox;return this.built&&this.cropped&&(b={left:a.left,top:a.top,width:a.width,height:a.height}),b||{}},setCropBoxData:function(b){var e,f,c=this.cropBox,d=this.options.aspectRatio;a.isFunction(b)&&(b=b.call(this.$element)),this.built&&this.cropped&&!this.disabled&&a.isPlainObject(b)&&(Y(b.left)&&(c.left=b.left),Y(b.top)&&(c.top=b.top),Y(b.width)&&b.width!==c.width&&(e=!0,c.width=b.width),Y(b.height)&&b.height!==c.height&&(f=!0,c.height=b.height),d&&(e?c.height=c.width/d:f&&(c.width=c.height*d)),this.renderCropBox())},getCroppedCanvas:function(b){var c,d,e,f,g,h,i,j,k,l,m;if(this.built&&this.cropped&&P)return a.isPlainObject(b)||(b={}),m=this.getData(),c=m.width,d=m.height,j=c/d,a.isPlainObject(b)&&(g=b.width,h=b.height,g?(h=g/j,i=g/c):h&&(g=h*j,i=h/d)),e=g||c,f=h||d,k=a("<canvas>")[0],k.width=e,k.height=f,l=k.getContext("2d"),b.fillColor&&(l.fillStyle=b.fillColor,l.fillRect(0,0,e,f)),l.drawImage.apply(l,function(){var j,k,l,n,o,p,a=ea(this.$clone[0],this.image),b=a.width,e=a.height,f=[a],g=m.x,h=m.y;return g<=-c||g>b?g=j=l=o=0:g<=0?(l=-g,g=0,j=o=R(b,c+g)):g<=b&&(l=0,j=o=R(c,b-g)),j<=0||h<=-d||h>e?h=k=n=p=0:h<=0?(n=-h,h=0,k=p=R(e,d+h)):h<=e&&(n=0,k=p=R(d,e-h)),f.push(g,h,j,k),i&&(l*=i,n*=i,o*=i,p*=i),o>0&&p>0&&f.push(l,n,o,p),f}.call(this)),k},setAspectRatio:function(a){var b=this.options;this.disabled||Z(a)||(b.aspectRatio=W(a)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var c,d,b=this.options;this.ready&&!this.disabled&&(c=b.dragCrop&&a===L,d=b.movable&&a===M,a=c||d?a:O,this.$dragBox.data("action",a).toggleClass(l,c).toggleClass(k,d),b.cropBoxMovable||this.$face.data("action",a).toggleClass(l,c).toggleClass(k,d))}}),a.extend(fa.prototype,X),fa.DEFAULTS={aspectRatio:NaN,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,dragCrop:!0,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,mouseWheelZoom:!0,wheelZoomRatio:.1,touchDragZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:535,minContainerHeight:400,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},fa.setDefaults=function(b){a.extend(fa.DEFAULTS,b)},fa.TEMPLATE='<div class="cropper-container"><div class="cropper-canvas"></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',fa.other=a.fn.cropper,a.fn.cropper=function(b){var d,c=$(arguments,1);return this.each(function(){var h,f=a(this),g=f.data(e);if(!g){if(/destroy/.test(b))return;f.data(e,g=new fa(this,b))}"string"==typeof b&&a.isFunction(h=g[b])&&(d=h.apply(g,c))}),Z(d)?this:d},a.fn.cropper.Constructor=fa,a.fn.cropper.setDefaults=fa.setDefaults,a.fn.cropper.noConflict=function(){return a.fn.cropper=fa.other,this}});
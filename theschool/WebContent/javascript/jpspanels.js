(function(e){e.jps.jpsWidget("jpsSplitter","",{});e.extend(e.jps._jpsSplitter.prototype,{defineInstance:function(){this.width=300;this.height=300;this.panels=[];this.orientation="vertical";this.disabled=false;this.splitBarSize=5;this.touchSplitBarSize=15;this.panel1=null;this.panel2=null;this._eventsMap={mousedown:e.jps.mobile.getTouchEventName("touchstart"),mouseup:e.jps.mobile.getTouchEventName("touchend"),mousemove:e.jps.mobile.getTouchEventName("touchmove"),mouseenter:"mouseenter",mouseleave:"mouseleave"};this._isTouchDevice=false;this._isNested=false;this.resizable=true;this.touchMode="auto";this.showSplitBar=true;this.initContent=null;this._events=["resize","expanded","collapsed","resizeStart","layout"]},createInstance:function(){this.render()},_initOverlay:function(t){if(this.overlay||t=="undefined"){this.overlay.remove();this.overlay=null}else{if(t==true){this.overlay=e("<div style='z-index: 100; background: #fff;'></div>");this.overlay.css("opacity",.01);this.overlay.css("position","absolute");this.overlay.appendTo(e(document.body));var n=this.host.coord();this.overlay.css("left","0px");this.overlay.css("top","0px");this.overlay.width(e(window).width());this.overlay.height(e(window).height());this.overlay.addClass("jps-disableselect");if(this.orientation=="horizontal"){this.overlay.css("cursor","row-resize")}else{this.overlay.css("cursor","col-resize")}}}},_startDrag:function(t){if(t.target==this.splitBarButton[0]||this.disabled){return true}if(this.panels[0].collapsed||this.panels[1].collapsed||!this.resizable){return true}if(this.overlay==null){this._dragging=true;this._initOverlay(true);this._dragStart=e.jps.position(t);return false}return true},_drag:function(t){if(this.panels[0].collapsed||this.panels[1].collapsed||this.disabled){return true}if(!this._dragging){return true}var n=this.orientation=="horizontal"?"top":"left";var r=this.orientation=="vertical"?"width":"height";this._position=e.jps.position(t);if(this.overlay&&!this._splitBarClone){if(Math.abs(this._position[n]-this._dragStart[n])>=3){var i=this.splitBar.coord();this._cloneStart={left:i.left,top:i.top};this._splitBarClone=this._createSplitBarClone();this._raiseEvent(3,{panels:this.panels});return}}if(this._splitBarClone){var s,o;var u=this.host[r]();var f=u/100;var l=1/f;var c=0;var h=this._splitBarClone[r]()+2;var p=parseInt(this.host.coord()[n]);var d=this._position[n]-this._dragStart[n]+this._cloneStart[n]-p;if(c>d){d=c}if(d>u+c-h){d=u+c-h}s=this.panels[0].min;o=this.panels[1].min;if(o.toString().indexOf("%")!=-1){o=parseFloat(o)*f}if(s.toString().indexOf("%")!=-1){s=parseFloat(s)*f}this._splitBarClone.removeClass(this.toThemeProperty("jps-splitter-splitbar-invalid"));if(d<s){this._splitBarClone.addClass(this.toThemeProperty("jps-splitter-splitbar-invalid"));d=s}if(d>u+c-h-o){this._splitBarClone.addClass(this.toThemeProperty("jps-splitter-splitbar-invalid"));d=u+c-h-o}this._splitBarClone.css(n,d);if(t.preventDefault){t.preventDefault()}if(t.stopPropagation){t.stopPropagation()}return false}return true},_resize:function(){var e=this.orientation=="horizontal"?"height":"width";var t=this.orientation=="horizontal"?"top":"left";var n=this._splitBarClone.css(t);var r=this.host[e]();var i=r/100;var s=1/i;var o=this.panels[0].size;if(o.toString().indexOf("%")!=-1){this.panels[0].size=parseFloat(n)*s+"%"}else{this.panels[0].size=parseFloat(n)}this._layoutPanels();this._raiseEvent(0,{panels:this.panels})},_stopDrag:function(){if(this._dragging){this._initOverlay()}this._dragging=false;if(this._splitBarClone){if(this.panels[0].collapsed||this.panels[1].collapsed||this.disabled){return true}this._resize();this._splitBarClone.remove();this._splitBarClone=null}},_createSplitBarClone:function(){var e=this.splitBar.clone();e.fadeTo(0,.7);e.css("z-index",99999);if(this.orientation=="vertical"){e.css("cursor","col-resize")}else{e.css("cursor","row-resize")}this.host.append(e);return e},_eventName:function(e){if(this._isTouchDevice){return this._eventsMap[e]}else{return e}},_addHandlers:function(){var t=this;e.jps.utilities.resize(this.host,function(){if(t.width&&t.width.toString().indexOf("%")!=-1||t.height&&t.height.toString().indexOf("%")!=-1){t._layoutPanels()}else{if(t.width==null||t.height==null){t._layoutPanels()}}});this.addHandler(this.host,"dragstart."+this.element.id,function(e){return false});if(this.splitBarButton){this.addHandler(this.splitBarButton,"click."+this.element.id,function(){var e=function(e){if(!e.collapsed){t.collapse()}else{t.expand()}};if(t.panels[0].collapsible){e(t.panels[0])}else{if(t.panels[1].collapsible){e(t.panels[1])}}});this.addHandler(this.splitBarButton,this._eventName("mouseenter"),function(){t.splitBarButton.addClass(t.toThemeProperty("jps-splitter-collapse-button-hover"));t.splitBarButton.addClass(t.toThemeProperty("jps-fill-state-hover"))});this.addHandler(this.splitBarButton,this._eventName("mouseleave"),function(){t.splitBarButton.removeClass(t.toThemeProperty("jps-splitter-collapse-button-hover"));t.splitBarButton.removeClass(t.toThemeProperty("jps-fill-state-hover"))})}this.addHandler(e(document),this._eventName("mousemove")+"."+this.element.id,function(e){return t._drag(e)});this.addHandler(e(document),this._eventName("mouseup")+"."+this.element.id,function(){return t._stopDrag()});this.addHandler(this.splitBar,this._eventName("mousedown"),function(e){return t._startDrag(e)});this.addHandler(this.splitBar,this._eventName("mouseenter"),function(){if(t.resizable&&!t.disabled){t.splitBar.addClass(t.toThemeProperty("jps-splitter-splitbar-hover"));t.splitBar.addClass(t.toThemeProperty("jps-fill-state-hover"))}});this.addHandler(this.splitBar,this._eventName("mouseleave"),function(){if(t.resizable&&!t.disabled){t.splitBar.removeClass(t.toThemeProperty("jps-splitter-splitbar-hover"));t.splitBar.removeClass(t.toThemeProperty("jps-fill-state-hover"))}});if(document.referrer!=""||window.frameElement){if(window.top!=null&&window.top!=window.self){var n=null;if(window.parent&&document.referrer){n=document.referrer}if(n&&n.indexOf(document.location.host)!=-1){var r=function(e){t._stopDrag()};if(window.top.document.addEventListener){window.top.document.addEventListener("mouseup",r,false)}else{if(window.top.document.attachEvent){window.top.document.attachEvent("onmouseup",r)}}}}}},_removeHandlers:function(){this.removeHandler(this.host,"dragstart."+this.element.id);this.removeHandler(e(window),"resize."+this.element.id);if(this.splitBarButton){this.removeHandler(this.splitBarButton,"click."+this.element.id);this.removeHandler(this.splitBarButton,this._eventName("mouseenter"));this.removeHandler(this.splitBarButton,this._eventName("mouseleave"))}this.removeHandler(e(document),this._eventName("mousemove")+"."+this.element.id);this.removeHandler(e(document),this._eventName("mouseup")+"."+this.element.id);if(this.splitBar){this.removeHandler(this.splitBar,this._eventName("mousedown"));this.removeHandler(this.splitBar,this._eventName("mouseenter"));this.removeHandler(this.splitBar,this._eventName("mouseleave"))}},render:function(){if(this.splitBar){this.splitBar.remove()}var t=this.host.children();if(t.length!=2){throw"Invalid HTML Structure! jpsSplitter requires 1 container DIV tag and 2 nested DIV tags."}if(t.length==2){var n=t[0].className.split(" ");var r=t[1].className.split(" ");if(n.indexOf("jps-reset")!=-1&&n.indexOf("jps-splitter")!=-1&&n.indexOf("jps-widget")!=-1){throw"Invalid HTML Structure! Nested jpsSplitter cannot be initialized from a Splitter Panel. You need to add a new DIV tag inside the Splitter Panel and initialize the nested jpsSplitter from it!"}if(r.indexOf("jps-reset")!=-1&&r.indexOf("jps-splitter")!=-1&&r.indexOf("jps-widget")!=-1){throw"Invalid HTML Structure! Nested jpsSplitter cannot be initialized from a Splitter Panel. You need to add a new DIV tag inside the Splitter Panel and initialize the nested jpsSplitter from it!"}}if(this.host.parent().length>0&&this.host.parent()[0].className.indexOf("jps-splitter")!=-1){if(this.element.className.indexOf("jps-splitter-panel")!=-1){throw"Invalid HTML Structure! Nested jpsSplitter cannot be initialized from a Splitter Panel. You need to add a new DIV tag inside the Splitter Panel and initialize the nested jpsSplitter from it!"}this._isNested=true;if(this.width==300){this.width="100%"}if(this.height==300){this.height="100%"}if(this.width=="100%"&&this.height=="100%"){this.host.addClass("jps-splitter-nested");if(this.host.parent()[0].className.indexOf("jps-splitter-panel")!=-1){this.host.parent().addClass("jps-splitter-panel-nested")}}}this._hasBorder=this.host.hasClass("jps-hideborder")==false||this.element.style.borderTopWidth!="";this._removeHandlers();this._isTouchDevice=e.jps.mobile.isTouchDevice();this._validate();this.panel1.css("left","0px");this.panel1.css("top","0px");this.panel2.css("left","0px");this.panel2.css("top","0px");this.splitBar=e("<div><div></div></div>");if(!this.resizable){this.splitBar.css("cursor","default")}this.splitBarButton=this.splitBar.find("div:last");this._setTheme();this.splitBar.insertAfter(this.panel1);this._arrange();if(this.panels[0].collapsible==false&&this.panels[1].collapsible==false){this.splitBarButton.hide()}var i=this;this._addHandlers();if(!this._displayTimer){if(this._hiddenParent()){this._displayTimer=setInterval(function(){try{if(!i._hiddenParent()){clearInterval(i._displayTimer);i._displayTimer=0;i.refresh()}}catch(e){}},10)}}if(this.initContent){this.initContent()}if(this.disabled){this.disable()}},_hiddenParent:function(){return e.jps.isHidden(this.host)},_setTheme:function(){this.panel1.addClass(this.toThemeProperty("jps-widget-content"));this.panel2.addClass(this.toThemeProperty("jps-widget-content"));this.panel1.addClass(this.toThemeProperty("jps-splitter-panel"));this.panel2.addClass(this.toThemeProperty("jps-splitter-panel"));this.panel1.addClass(this.toThemeProperty("jps-reset"));this.panel2.addClass(this.toThemeProperty("jps-reset"));this.host.addClass(this.toThemeProperty("jps-reset"));this.host.addClass(this.toThemeProperty("jps-splitter"));this.host.addClass(this.toThemeProperty("jps-widget"));this.host.addClass(this.toThemeProperty("jps-widget-content"));this.splitBar.addClass(this.toThemeProperty("jps-splitter-splitbar-"+this.orientation));this.splitBar.addClass(this.toThemeProperty("jps-fill-state-normal"));this.splitBarButton.addClass(this.toThemeProperty("jps-splitter-collapse-button-"+this.orientation));this.splitBarButton.addClass(this.toThemeProperty("jps-fill-state-pressed"))},_validate:function(){var t=this.host.children();if(t.length!=2){throw"Invalid HTML Structure! jpsSplitter requires two nested DIV tags!"}if(this.panels&&!this.panels[1]){if(!this.panels[0]){this.panels=[{size:"50%"},{size:"50%"}]}else{this.panels[1]={}}}else{if(this.panels==undefined){this.panels=[{size:"50%"},{size:"50%"}]}}var t=this.host.children();this.panel1=this.panels[0].element=e(t[0]);this.panel2=this.panels[1].element=e(t[1]);this.panel1[0].style.minWidth="";this.panel1[0].style.maxWidth="";this.panel2[0].style.minWidth="";this.panel2[0].style.maxWidth="";e.each(this.panels,function(){if(this.min==undefined){this.min=0}if(this.size==undefined){this.size=0}if(this.size<0){this.size=0}if(this.min<0){this.min=0}if(this.collapsible==undefined){this.collapsible=true}if(this.collapsed==undefined){this.collapsed=false}if(this.size!=0){if(this.size.toString().indexOf("%")==-1){if(parseInt(this.min)>parseInt(this.size)){this.min=this.size}}else{if(this.min.toString().indexOf("%")!=-1){if(parseInt(this.min)>parseInt(this.size)){this.min=this.size}}}}})},_arrange:function(){if(this.width!=null){var e=this.width;if(typeof e!="string"){e=parseInt(this.width)+"px"}this.host.css("width",e)}if(this.height!=null){var t=this.height;if(typeof t!="string"){t=parseInt(this.height)+"px"}this.host.css("height",t)}this._splitBarSize=!this._isTouchDevice?this.splitBarSize:this.touchSplitBarSize;if(!this.showSplitBar){this._splitBarSize=0;this.splitBar.hide()}var n=this.orientation=="horizontal"?"width":"height";this.splitBar.css(n,"100%");this.panel1.css(n,"100%");this.panel2.css(n,"100%");if(this.orientation=="horizontal"){this.splitBar.height(this._splitBarSize)}else{this.splitBar.width(this._splitBarSize)}if(this.orientation==="vertical"){this.splitBarButton.width(this._splitBarSize);this.splitBarButton.height(45)}else{this.splitBarButton.height(this._splitBarSize);this.splitBarButton.width(45)}this.splitBarButton.css("position","relative");if(this.orientation==="vertical"){this.splitBarButton.css("top","50%");this.splitBarButton.css("left","0");this.splitBarButton.css("margin-top","-23px");this.splitBarButton.css("margin-left","-0px")}else{this.splitBarButton.css("left","50%");this.splitBarButton.css("top","0");this.splitBarButton.css("margin-left","-23px");this.splitBarButton.css("margin-top","-0px")}this._layoutPanels()},collapse:function(){if(this.disabled){return}var e=-1;this.panels[0].collapsed=this.panels[1].collapsed=false;this.panels[0].element[0].style.visibility="inherit";this.panels[1].element[0].style.visibility="inherit";if(this.panels[0].collapsible){e=0}else{if(this.panels[1].collapsible){e=1}}if(e!=-1){this.panels[e].collapsed=true;this.panels[e].element[0].style.visibility="hidden";this.splitBar.addClass(this.toThemeProperty("jps-splitter-splitbar-collapsed"));this._layoutPanels();this._raiseEvent(2,{index:e,panels:this.panels});this._raiseEvent(0,{panels:this.panels})}},expand:function(){if(this.disabled){return}var e=-1;this.panels[0].collapsed=this.panels[1].collapsed=false;this.panels[0].element[0].style.visibility="inherit";this.panels[1].element[0].style.visibility="inherit";if(this.panels[0].collapsible){e=0}else{if(this.panels[1].collapsible){e=1}}if(e!=-1){this.panels[e].collapsed=false;this.panels[e].element[0].style.visibility="inherit";this.splitBar.removeClass(this.toThemeProperty("jps-splitter-splitbar-collapsed"));this._layoutPanels();this._raiseEvent(1,{index:e,panels:this.panels});this._raiseEvent(0,{panels:this.panels})}},disable:function(){this.disabled=true;this.host.addClass(this.toThemeProperty("jps-fill-state-disabled"));this.splitBar.addClass(this.toThemeProperty("jps-splitter-splitbar-collapsed"));this.splitBarButton.addClass(this.toThemeProperty("jps-splitter-splitbar-collapsed"))},enable:function(){this.disabled=false;this.host.removeClass(this.toThemeProperty("jps-fill-state-disabled"));this.splitBar.removeClass(this.toThemeProperty("jps-splitter-splitbar-collapsed"));this.splitBarButton.removeClass(this.toThemeProperty("jps-splitter-splitbar-collapsed"))},refresh:function(e){if(e!=true){this._arrange()}},propertyChangedHandler:function(t,n,r,i){if(n==="panels"||n==="orientation"||n==="showSplitBar"){t.render();return}if(n==="touchMode"){t._isTouchDevice=i}if(n==="disabled"){if(i){t.disable()}else{t.enable()}}else{if(n==="theme"){e.jps.utilities.setTheme(r,i,t.host)}else{t.refresh()}}},_layoutPanels:function(){var e=this;var t=this.orientation=="horizontal"?"height":"width";var n=this.orientation=="horizontal"?"top":"left";var r,i,s,o;var u=parseInt(this._splitBarSize)+2;if(!this.showSplitBar){u=0}var a=this.host[t]();var f=a/100;var l=1/f;var c=l*u;var h=this.panel1;var p=this.panel2;var d=this.panels[0].size;if(this.panels[0].collapsed){s=true}if(this.panels[1].collapsed){o=true}r=this.panels[0].min;i=this.panels[1].min;if(i.toString().indexOf("%")!=-1){i=parseFloat(i)*f}if(r.toString().indexOf("%")!=-1){r=parseFloat(r)*f}if(this._isNested&&this._isTouchDevice){if(this.orientation=="horizontal"){h.width(this.host.width());p.width(this.host.width())}else{h.height(this.host.height());p.height(this.host.height())}}var v=function(){var r=e.panel1[t]();if(e.splitBar[0].style[n]!=r+"px"){var i=r;if(e.orientation=="vertical"){e.splitBar[0].style.borderLeftColor="";e.splitBar[0].style.borderRightColor="";e.splitBarButton.width(e._splitBarSize);e.splitBarButton.css("left","0px")}else{e.splitBar[0].style.borderTopColor="";e.splitBar[0].style.borderBottomColor="";e.splitBarButton.height(e._splitBarSize);e.splitBarButton.css("top","0px")}if(e._hasBorder){if(a-u==r){if(e.orientation=="vertical"){e.splitBar[0].style.borderRightColor="transparent";e.splitBarButton.width(e._splitBarSize+1)}else{e.splitBar[0].style.borderBottomColor="transparent";e.splitBarButton.height(e._splitBarSize+1)}}else{if(r==0){if(e.orientation=="vertical"){e.splitBar[0].style.borderLeftColor="transparent";e.splitBarButton.width(e._splitBarSize+1);e.splitBarButton.css("left","-1px")}else{e.splitBar[0].style.borderTopColor="transparent";e.splitBarButton.height(e._splitBarSize+1);e.splitBarButton.css("top","-1px")}}}}e.splitBar.css(n,i+"px")}if(e.panel2[0].style[n]!=r+u+"px"){e.panel2.css(n,r+u+"px")}};if(s){var m=Math.max(i,a-u);h[t](0);p[t](m)}else{if(o){var m=Math.max(r,a-u);p[t](0);h[t](m)}else{if(d.toString().indexOf("%")!=-1){var g=100-parseFloat(d);h.css(t,parseFloat(d)+"%");g-=c;p.css(t,g+"%");var y=p[t]();if(y<i){var m=y-i;var b=m*l;d=parseFloat(d)+parseFloat(b);var g=100-parseFloat(d);h.css(t,parseFloat(d)+"%");g-=c;p.css(t,g+"%")}var w=h[t]();if(w<r){var b=r*l;h.css(t,parseFloat(b)+"%")}}else{var y=a-d-u;if(h[0].style[t]!=d+"px"){h[t](d)}if(p[0].style[t]!=y+"px"){p[t](y)}if(y<i){d+=y-i;p[t](i);h[t](d)}if(d<r){h[t](r)}}}}v();this._raiseEvent(4,{panels:this.panels})},destroy:function(){this._removeHandlers();this.host.remove()},_raiseEvent:function(t,n){var r=new e.Event(this._events[t]);r.owner=this;r.args=n;var i=this.orientation=="vertical"?"width":"height";var s=new Array;s[0]={};s[1]={};s[0].size=this.panel1[i]();s[1].size=this.panel2[i]();s[0].min=this.panels[0].min;s[1].min=this.panels[1].min;s[0].collapsible=this.panels[0].collapsible;s[1].collapsible=this.panels[1].collapsible;s[0].collapsed=this.panels[0].collapsed;s[1].collapsed=this.panels[1].collapsed;r.args.panels=s;return this.host.trigger(r)}})})(jQuery)